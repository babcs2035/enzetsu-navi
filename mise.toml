[tools]
node = "25.4.0"
pnpm = "10.28.2"

[tasks]
# --- Setup ---
setup = { description = "依存関係のインストール、DB起動、スキーマ適用、シード実行", depends = ["db:up"], run = "pnpm install && pnpm exec playwright install chromium && pnpm prisma db push && pnpm prisma generate && pnpm prisma db seed" }

# --- Development ---
dev = { description = "開発サーバー起動 (DB起動 + Next.js)", depends = ["db:up"], run = "pnpm dev" }
lint = { description = "Lint & Format (Biome)", run = "pnpm lint" }
check = { description = "コード品質チェック (Lint, Format, TypeCheck)", run = "pnpm check" }

# --- Build ---
build = { description = "プロダクションビルド", depends = ["db:up"], run = "pnpm build" }

# --- Database (Prisma) ---
"db:up" = { description = "DBコンテナ起動 (待機あり)", run = "docker compose up -d db --wait" }
"db:down" = { description = "DBコンテナ停止", run = "docker compose stop db" }
"db:studio" = { description = "Prisma Studio (管理GUI) 起動", run = "pnpm prisma studio" }
"db:generate" = { description = "Prisma Client 生成", run = "pnpm prisma generate" }
"db:reset" = { description = "DB リセット（全データ削除 & シード）", run = "pnpm prisma db push --force-reset && pnpm prisma db seed" }

# --- Docker ---
docker = { description = "フルスタック起動 (App + DB)", run = "docker compose up -d" }
"docker:logs" = { description = "コンテナログ表示", run = "docker compose logs -f" }
"docker:build" = { description = "Dockerイメージビルド", run = "docker compose build" }

# --- Utility ---
clean = { description = "一時ファイル削除", run = "rm -rf node_modules .next" }
scrape = { description = "手動スクレイピング実行 (引数なしで全件，または政党名指定)", run = "pnpm tsx scripts/scrape.ts" }
